<?php
defined('BASEPATH') OR exit('No direct script access allowed');

class XXX extends CI_Controller {

	private $tabla = 'xxx';

	public function index(){
		$data['formulario'] = $this->formulario($this->tabla,'new');
		$data['lista']  = $this -> Request_model -> grid($this->tabla);
		$data['yield_data'] = $this->load->view($this->tabla.'/list',$data,true);
		$this->load->view('layout/index',$data);	
	}
	public function show($id){
		$data['fields'] = $this -> Request_model -> form($this->tabla,$id);
		$data['lista']  = $this -> Request_model -> item($this->tabla,$id);
		$data['yield_data'] = $this->load->view($this->tabla.'/show',$data,true);
		$this->load->view('layout/index',$data);
	}
	public function edit($id='new'){
		$data['formulario'] = $this->formulario($this->tabla,$id);
		$data['yield_data'] = $this->load->view($this->tabla.'/edit',$data,true);
		$this->load->view('layout/index',$data);
	}
	public function update($data){
		if ( ! $this->session->has_userdata('id_users') and !isset($_POST['action']) )
			redirect( URL.'users/sign_in' );
		$action = $_POST['action'];
		$re = $this -> Request_model -> update();
		$this->session->set_flashdata('update', $re );
		redirect($action);
	}
	private function formulario($id='new'){
		$fields = $this -> Request_model -> form($this->tabla,$id);
		return listasimple($fields);
	}

}


&&&<?php
###### EDIT ######

?>

<h1>Edit <?=ucwords($tabla)?></h1>
<?=$formulario?>

<!--
<script src="//cdn.ckeditor.com/4.7.0/full/ckeditor.js"></script>

<script>
    CKEDITOR.replace( 'textarea_by_id' );
</script>
-->

&&&<?php
###### LIST ######
?>
<?=$update?>
<h1>
	List <?=ucwords($tabla)?>
	<a href='#' class='btn btn-success' data-toggle='modal' data-target='#modal_editar_item'>Agregar con Modal</a>
	<a href="<?=URL.$tabla.'/edit/new'?>" class='btn btn-success'>Agregar</a>
</h1>

<?=$li?>

<?=$modal?>

&&&<?php
###### SHOW ######
$li = '';
foreach ($lista as $key => $value){
	$$key = $value;
	$li.=' <span class="badge badge-light" style="width:200px" >'.ucwords(str_replace('_',' ',$key)).'</span>';
	$li.=' <input disabled value="'.$value.'"  style="width:200px" ><br>';
}

?>
<?=$update?>
<h1>Show <?=ucwords( $tabla ) ?> 
	<a href='#' class='btn btn-success' data-toggle='modal' data-target='#modal_editar_item'>Editar</a>
</h1>

<?=$li?>


<?=$modal?>
