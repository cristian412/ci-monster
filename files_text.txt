<?php
defined('BASEPATH') OR exit('No direct script access allowed');

class XXX extends CI_Controller {
	private $tabla = 'xxx';
	public function index(){
		$action = $tabla = $this->tabla;
		if( $this->uri->segment(1) == 'tables' )	$action = URL.'tables/'.$action;
		$data['update'] = $this -> Request_model -> update();
		$data['fields'] = $this -> Request_model -> form($tabla,'new',$action);
		$data['lista']  = $this -> Request_model -> grid($tabla);
		$data['yield_data'] = $this->load->view('tables/'.$tabla.'/list',$data,true);
	    $this->load->view(LAYOUT.'index',$data);	
	}
	public function show(){
		$tabla = $this->tabla;
		$id = $this->uri->segment(3);
		if( $this->uri->segment(1) == 'tables' ) $id = $this->uri->segment(4);
		$data['update'] = $this -> Request_model -> update();
		$data['tabla'] = $tabla;
		$data['fields'] = $this -> Request_model -> form($tabla,$id);
		$data['lista']  = $this -> Request_model -> item($tabla,$id);
		$data['yield_data'] = $this->load->view('tables/'.$tabla.'/show',$data,true);
		$this->load->view(LAYOUT.'index',$data);
	}
	public function edit(){
		$tabla = $this->tabla;
		$id = $this->uri->segment(3);
		if( $this->uri->segment(1) == 'tables' ) $id = $this->uri->segment(4);
		if(empty($id)) $id = 'new';
		$data['fields'] = $this -> Request_model -> form($tabla,$id);
		$data['yield_data'] = $this->load->view('tables/'.$tabla.'/edit',$data,true);
		$this->load->view(LAYOUT.'index',$data);
	}
}

&&&
<?php
# SETEAR EL FORMULARIO

//$fields['nro']['col'] = '1';

$formulario = formbasico($fields);
?>

<h1>Edit <?=$fields['tabla']['value']?></h1>
<?=$formulario?>

<!--
<script>
    CKEDITOR.replace( 'textarea_by_id' );
</script>
-->

&&&
<?php
$tabla = $lista['meta']['tabla'];
$add_url = $fields['tabla']['action'].'/edit/new';
# SETEAMOS LA LISTA
//unset($lista['columna']['id_juicio']);
if( count($lista['contenido'])<10  )
	$li = listasimple($lista,'','');
else
	$li = listasimple($lista);
# SETEAR EL FORMULARIO
//$fields['nro']['col'] = '1';
$formulario = formbasico($fields);
$modal = modal($formulario);

?>
<?=$update?>
<h1>
	Lista <?=ucwords($lista['meta']['tabla'])?>
	<a href='#' class='btn btn-success' data-toggle='modal' data-target='#editar-item'>Agregar con Modal</a>
	<a href='<?=$add_url?>' class='btn btn-success'>Agregar</a>
</h1>
<?//=pre($lista)?>
<?//=pre($fields)?>

<?=$li?>

<?=$modal?>

&&&
<?php
foreach ($lista as $key => $value) $$key = $value;

# SETEAR EL FORMULARIO
//$fields['nro']['col'] = '1';
$formulario = formbasico($fields);
$modal = modal($formulario,'editar-item');
?>
<?=$update?>
<h1>Show <?=ucwords( $tabla ) ?> 
	<a href='#' class='btn btn-success' data-toggle='modal' data-target='#editar-item'>Editar</a>
</h1>

<?=pre($lista)?>


<?=$modal?>
