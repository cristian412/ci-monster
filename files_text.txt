<?php
defined('BASEPATH') OR exit('No direct script access allowed');

class XXX extends CI_Controller {

	private $tabla = 'xxx';

	public function index(){
		$data['update'] = $this -> Request_model -> update();
		$data['tabla'] = $this->tabla;

		# SETEAMOS LA LISTA
		$lista  = $this -> Request_model -> grid($this->tabla);
		//unset($lista['columna']['id_juicio']);
		if( count($lista['contenido'])<10  )
			$data['li'] = listasimple($lista,'',''); 
		else
			$data['li'] = listasimple($lista);

		$formulario = $this->formulario('new');

		$data['modal'] = modal($formulario,'modal_editar_item');

		$data['yield_data'] = $this->load->view($this->tabla.'/list',$data,true);
	    $this->load->view(LAYOUT.'index',$data);	
	}
	public function show($id){
		$data['update'] = $this -> Request_model -> update();
		$data['tabla']  = $this->tabla;
		$data['lista']  = $this -> Request_model -> item($this->tabla,$id);

		$formulario = $this->formulario($id);

		$data['modal'] = modal($formulario,'modal_editar_item');

		$data['yield_data'] = $this->load->view($this->tabla.'/show',$data,true);
		$this->load->view(LAYOUT.'index',$data);
	}
	public function edit($id){
		$data['tabla'] = $this->tabla;
		if (empty($id)) $id = 'new';

		$data['formulario'] = $this->formulario($id);

		$data['yield_data'] = $this->load->view($this->tabla.'/edit',$data,true);
		$this->load->view(LAYOUT.'index',$data);
	}
	private function formulario($id){
		$fields = $this -> Request_model -> form($this->tabla,$id);
		# SETEAR EL FORMULARIO
		//$fields['nro']['col'] = '1';
		return formbasico($fields);

	}
}

&&&<?php
###### EDIT ######

?>

<h1>Edit <?=ucwords($tabla)?></h1>
<?=$formulario?>

<!--
<script src="//cdn.ckeditor.com/4.7.0/full/ckeditor.js"></script>

<script>
    CKEDITOR.replace( 'textarea_by_id' );
</script>
-->

&&&<?php
###### LIST ######
?>
<?=$update?>
<h1>
	List <?=ucwords($tabla)?>
	<a href='#' class='btn btn-success' data-toggle='modal' data-target='#modal_editar_item'>Agregar con Modal</a>
	<a href="<?=URL.$tabla.'/edit/new'?>" class='btn btn-success'>Agregar</a>
</h1>

<?=$li?>

<?=$modal?>

&&&<?php
###### SHOW ######

foreach ($lista as $key => $value) $$key = $value;

?>
<?=$update?>
<h1>Show <?=ucwords( $tabla ) ?> 
	<a href='#' class='btn btn-success' data-toggle='modal' data-target='#modal_editar_item'>Editar</a>
</h1>

<?=pre($lista)?>

<?=$modal?>
