<?php
defined('BASEPATH') OR exit('No direct script access allowed');

class XXX extends CI_Controller {

	private $tabla = 'xxx';

	public function index(){
		$data['update'] = $this -> Request_model -> update();
		$data['tabla'] = $tabla = $this->tabla;

		# SETEAMOS LA LISTA
		$lista  = $this -> Request_model -> grid($tabla);
		//unset($lista['columna']['id_juicio']);
		if( count($data['lista']['contenido'])<10  )
			$data['li'] = listasimple($lista,'',''); 
		else
			$data['li'] = listasimple($lista);

		# SETEAR EL FORMULARIO
		$fields = $this -> Request_model -> form($tabla,'new');
		//$fields['nro']['col'] = '1';
		$formulario = formbasico($fields);
		$data['modal'] = modal($formulario,'modal_editar');

		$data['yield_data'] = $this->load->view('tables/'.$tabla.'/list',$data,true);
	    $this->load->view(LAYOUT.'index',$data);	
	}
	public function show(){
		$data['update'] = $this -> Request_model -> update();
		$data['tabla'] = $tabla = $this->tabla;
		$id = $this->uri->segment(4);
		$data['lista']  = $this -> Request_model -> item($tabla,$id);

		# SETEAR EL FORMULARIO
		$fields = $this -> Request_model -> form($tabla,$id);
		//$fields['nro']['col'] = '1';
		$formulario = formbasico($fields);
		$data['modal'] = modal($formulario,'editar-item');

		$data['yield_data'] = $this->load->view('tables/'.$tabla.'/show',$data,true);
		$this->load->view(LAYOUT.'index',$data);
	}
	public function edit(){
		$data['tabla'] = $tabla = $this->tabla;
		$id = $this->uri->segment(4);
		if (empty($id)) $id = 'new';
		
		$fields = $this -> Request_model -> form($tabla,$id);
		# SETEAR EL FORMULARIO
		//$fields['nro']['col'] = '1';
		$data['formulario'] = formbasico($fields);

		$data['yield_data'] = $this->load->view('tables/'.$tabla.'/edit',$data,true);
		$this->load->view(LAYOUT.'index',$data);
	}
}

&&&<?php
###### EDIT ######

?>

<h1>Edit <?=ucwords($tabla)?></h1>
<?=$formulario?>

<!--
<script src="//cdn.ckeditor.com/4.7.0/full/ckeditor.js"></script>

<script>
    CKEDITOR.replace( 'textarea_by_id' );
</script>
-->

&&&<?php
###### LIST ######
?>
<?=$update?>
<h1>
	List <?=ucwords($tabla)?>
	<a href='#' class='btn btn-success' data-toggle='modal' data-target='#modal_editar'>Agregar con Modal</a>
	<a href="<?=URL.'tables/'.$tabla.'/edit/new'?>" class='btn btn-success'>Agregar</a>
</h1>

<?=$li?>

<?=$modal?>

&&&<?php
###### SHOW ######

foreach ($lista as $key => $value) $$key = $value;

?>
<?=$update?>
<h1>Show <?=ucwords( $tabla ) ?> 
	<a href='#' class='btn btn-success' data-toggle='modal' data-target='#editar-item'>Editar</a>
</h1>

<?=pre($lista)?>

<?=$modal?>
